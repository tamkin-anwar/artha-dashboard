<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% block title %}Artha Dashboard{% endblock %}</title>

    <!-- PWA -->
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    <meta name="theme-color" content="#2563eb">

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">

    <!-- Prevent FOUC: apply theme class early -->
    <script>
        (function () {
            try {
                const stored = localStorage.getItem("theme");
                const prefersDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
                if (stored === "dark" || (!stored && prefersDark)) {
                    document.documentElement.classList.add("dark");
                } else {
                    document.documentElement.classList.remove("dark");
                }
            } catch (e) {}
        })();
    </script>

    <!-- Tailwind (CDN for now) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = { darkMode: "class" };
    </script>

    <!-- App CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/toast.css') }}">

    <!-- Vendor (LOCAL) -->
    <!-- IMPORTANT: these expose globals Chart, ChartDataLabels, Sortable -->
    <script defer src="{{ url_for('static', filename='vendor/chart.umd.min.js') }}"></script>
    <script defer src="{{ url_for('static', filename='vendor/chartjs-plugin-datalabels.min.js') }}"></script>
    <script defer src="{{ url_for('static', filename='vendor/sortable.min.js') }}"></script>
</head>

<body class="bg-white text-gray-900 dark:bg-gray-900 dark:text-white transition-colors duration-300" role="document">
    <noscript>
        <div class="bg-red-100 text-red-800 p-4 text-center font-semibold">
            JavaScript is disabled in your browser. This app requires JavaScript to function properly.
        </div>
    </noscript>

    {% block content %}{% endblock %}

    <!-- SINGLE entrypoint (modules) -->
    <script type="module" src="{{ url_for('static', filename='js/init.js') }}"></script>
</body>
</html>