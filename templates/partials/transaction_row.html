<li class="flex items-center justify-between px-4 py-3 bg-white dark:bg-gray-700 rounded-lg shadow-sm"
    data-id="{{ tx.id }}">

    <!-- UPDATE TRANSACTION (AJAX-first, form fallback) -->
    <form method="POST"
            action="{{ url_for('update_transaction', transaction_id=tx.id) }}"
            class="flex-grow flex flex-col sm:flex-row sm:items-center gap-2">

            <!-- CSRF token (required even for fallback POST) -->
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <!-- Editable description -->
            <span contenteditable="true"
                data-id="{{ tx.id }}"
                class="tx-desc w-full sm:w-1/3 bg-transparent outline-none text-black dark:text-white">
                {{ tx.description }}
            </span>

            <!-- Editable amount -->
            <span contenteditable="true"
                data-id="{{ tx.id }}"
                data-type="{{ tx.type }}"
                class="tx-amount w-full sm:w-1/4 bg-transparent outline-none text-right">
            ${{ "%.2f"|format(tx.amount) }}
        </span>

        <!-- Type dropdown -->
        <select data-id="{{ tx.id }}"
                class="tx-type min-w-[100px] sm:w-[110px] bg-white dark:bg-gray-900 text-black dark:text-white border border-gray-300 dark:border-gray-700 rounded px-2 py-1">
            <option value="income" {% if tx.type == "income" %}selected{% endif %}>Income</option>
            <option value="expense" {% if tx.type == "expense" %}selected{% endif %}>Expense</option>
        </select>

        <!-- Hidden submit for non-JS fallback -->
        <button type="submit" class="hidden">Save</button>
    </form>

    <!-- DELETE TRANSACTION (AJAX + POST fallback) -->
    <form class="tx-delete-form"
            method="POST"
            action="{{ url_for('delete_transaction', transaction_id=tx.id) }}">

        <!-- CSRF token REQUIRED -->
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <button type="submit"
                class="ml-3 text-red-500 hover:text-red-700 text-xl"
                title="Delete">
            üóëÔ∏è
        </button>
    </form>
</li>