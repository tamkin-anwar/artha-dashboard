{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}

<!-- Top Navbar -->
<header class="w-full px-6 py-4 shadow-md bg-white dark:bg-gray-800" role="banner">
    <div class="flex justify-between items-center">
        <h1 class="text-xl font-bold flex items-center space-x-2">
            <span class="w-6 h-6 text-blue-600 dark:text-blue-400">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24" class="w-6 h-6">
                    <title>Artha Logo</title>
                    <path d="M0 11.981C.004 5.612 4.965.403 11.233.002L11.268 0v11.981c0 .139.038.269.105.379l-.002-.003l5.989 10.378A11.831 11.831 0 0 1 12 23.999c-6.627 0-12-5.373-12-12v-.018v.001zm13.318.752H24a12.006 12.006 0 0 1-5.291 9.231l-.043.027zm-.548-1.503V0c6.04.388 10.842 5.19 11.229 11.194l.002.035z"/>
                </svg>
            </span>
            <span>Artha Dashboard</span>
        </h1>
        <div class="md:hidden">
            <button id="menu-btn" class="focus:outline-none" aria-expanded="false" aria-controls="mobile-menu">â˜°</button>
        </div>
        <nav id="nav-menu" class="hidden md:flex space-x-4 items-center" aria-label="Main navigation">
            <a href="{{ url_for('logout') }}" class="px-3 py-1 rounded border border-gray-300 dark:border-gray-600">Logout</a>
            <button id="toggle-theme" class="px-3 py-1 rounded border border-gray-300 dark:border-gray-600">Toggle Theme</button>
        </nav>
    </div>
    <div id="mobile-menu" class="md:hidden mt-2 hidden" aria-label="Mobile navigation">
        <a href="{{ url_for('logout') }}" class="block px-3 py-1 border border-gray-300 dark:border-gray-600 rounded mb-2">Logout</a>
        <button id="toggle-theme-mobile" class="w-full px-3 py-1 rounded border border-gray-300 dark:border-gray-600">Toggle Theme</button>
    </div>
</header>

<!-- Main Dashboard -->
<main class="p-4 sm:p-6" role="main">
    <h1 class="text-xl font-bold mb-6">
        Welcome, {{ current_user.first_name.capitalize() if current_user.first_name else current_user.username.capitalize() }}
    </h1>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div aria-live="polite" role="status">
                {% for category, message in messages %}
                    <p class="flash-message text-sm text-center mb-2 {% if category == 'success' %}text-green-500{% elif category == 'error' %}text-red-500{% else %}text-blue-500{% endif %}">
                        {{ message|safe }}
                    </p>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <!-- Dashboard Widgets -->
    <section id="dashboard-widgets" class="grid gap-4 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3" aria-label="Dashboard widgets">
        <div class="widget" id="widget-finance">{% include "widgets/finance.html" %}</div>
        <div class="widget" id="widget-notes">{% include "widgets/notes.html" %}</div>
        <div class="widget" id="widget-chart">{% include "widgets/chart.html" %}</div>
        <div class="widget" id="widget-calculator">{% include "widgets/calculator.html" %}</div>
        <div class="widget" id="widget-calendar">{% include "widgets/calendar.html" %}</div>
    </section>
</main>
{% endblock %}